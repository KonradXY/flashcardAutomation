<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308716 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="504"/>

<div>
<span><div><h2><span style="font-size: 14pt;"><b>20 - State Pattern</b></span></h2><div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="width: 846px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">D:   can you give the gof definition of the state pattern ?</span></div></td></tr><tr><td style="width: 846px; padding: 8px; border: 1px solid;"><div>R: Allow an object to alter its behavior when its internal state changes. The object will appear to change its class.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   can you give an example with a uml diagram of the state pattern ?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R: The following implementation models the functionalities of a television and its remote control. Suppose that you have a remote control to support the operations of a TV. You can simply assume that at any given time, the TV is in either of these three states: On, Off, or Mute. Initially, the TV is in the Off state. When you press the On button on the remote control, the TV goes into the On state. If you press the Mute button, it goes into the Mute state.</div><div><span style="font-style: italic;">You can assume that if you press the Off button when the TV is already in the Off state, or if you press the On button when the TV is already in the On state, or if you press the Mute button when the TV is already in Mute mode, there is no state change for the TV.</span></div><div>The TV can go into the Off state from the On state if you press the Off button, or it goes into a Mute state if you press the Mute button</div><h3><span style="font-weight: bold;">KEY CHARACTERISTICS</span></h3><div>The key characteristics of the following implementations are as follows.</div><ul><li><div>For a state-specific behavior, you have separate classes. For example, here you have classes like On, Off, and Mute.</div></li><li><div>The TV class is the main class here (the word <span style="font-style: italic;">main</span> does not mean that it includes the main() method) and the client code only talks to it. In design pattern terms, TV is the context class here.</div></li><li><div>Operations defined in the TV class are delegating the behaviour to the current state’s object implementation.</div></li><li><div>PossibleState is the interface that defines the methods/operations that are called when you own an object. On, Off, and Mute are concrete states that implement this interface.</div></li><li><div>States are triggering state transitions (one state to another state) themselves.</div></li></ul><h3><span style="font-size: 11pt;"><br/></span></h3><div><img src="20 - State Pattern_files/Image.jpg" type="image/jpeg" data-filename="Image.jpg" style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; -webkit-font-smoothing: antialiased; border: 0px; height: 32.78em; max-width: 100%; vertical-align: middle; margin: 0px; padding: 2px;" width="809"/></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   Can you show an implementation of the state pattern ?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R: Here’s the implementation.</div><div><font face="Source Code Pro"><br/></font></div><div><font face="Source Code Pro">package jdp2e.state.demo;</font></div><div><font face="Source Code Pro">interface PossibleState</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   void pressOnButton(TV context);</font></div><div><font face="Source Code Pro">   void pressOffButton(TV context);</font></div><div><font face="Source Code Pro">   void pressMuteButton(TV context);</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">//Off state</font></div><div><font face="Source Code Pro">class Off implements  PossibleState</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   //User is pressing Off button when the TV is in Off state</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOnButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed On button. Going from Off to On state.&quot;);</font></div><div><font face="Source Code Pro">       context.setCurrentState(new On());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(context.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //TV is Off already, user is pressing Off button again</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOffButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed Off button. TV is already in Off state.&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //User is pressing Mute button when the TV is in Off state</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressMuteButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed Mute button.TV is already in Off state, so Mute operation will not work.&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public String toString()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return &quot;\t**TV is switched off now.**&quot;;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">//On state</font></div><div><font face="Source Code Pro">class On implements PossibleState</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   //TV is On already, user is pressing On button again</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOnButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed On button. TV is already in On state.&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //User is pressing Off button when the TV is in On state</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOffButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed Off button.Going from On to Off state.&quot;);</font></div><div><font face="Source Code Pro">       context.setCurrentState(new Off());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(context.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //User is pressing Mute button when the TV is in On state</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressMuteButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed Mute button.Going from On to Mute mode.&quot;);</font></div><div><font face="Source Code Pro">       context.setCurrentState(new Mute());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(context.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public String toString()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return &quot;\t**TV is switched on now.**&quot;;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">//Mute state</font></div><div><font face="Source Code Pro">class Mute implements PossibleState</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   //User is pressing On button when the TV is in Mute mode</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOnButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed On button.Going from Mute mode to On state.&quot;);</font></div><div><font face="Source Code Pro">       context.setCurrentState(new On());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(context.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //User is pressing Off button when the TV is in Mute mode</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOffButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed Off button. Going from Mute mode to Off state.&quot;);</font></div><div><font face="Source Code Pro">       context.setCurrentState(new Off());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(context.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //TV is in mute mode already, user is pressing mute button again</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressMuteButton(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed Mute button.TV is already in Mute mode.&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public String toString()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return &quot;\t**TV is silent(mute) now**&quot;;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class TV</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   private PossibleState currentState;</font></div><div><font face="Source Code Pro">   public TV()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       //Initially TV is initialized with Off state</font></div><div><font face="Source Code Pro">       this.setCurrentState(new Off());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public PossibleState getCurrentState()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return currentState;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void setCurrentState(PossibleState currentState)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       this.currentState = currentState;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void pressOffButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       currentState.pressOffButton(this);//Delegating the state</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void pressOnButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       currentState.pressOnButton(this);//Delegating the state</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void pressMuteButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       currentState.pressMuteButton(this);//Delegating the state</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">//Client</font></div><div><font face="Source Code Pro">public class StatePatternExample {</font></div><div><font face="Source Code Pro">   public static void main(String[] args) {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;***State Pattern Demo***\n&quot;);</font></div><div><font face="Source Code Pro">       //Initially TV is Off.</font></div><div><font face="Source Code Pro">       TV tv = new TV();</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;User is pressing buttons in the following sequence:&quot;);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;Off-&gt;Mute-&gt;On-&gt;On-&gt;Mute-&gt;Mute-&gt;Off\n&quot;);</font></div><div><font face="Source Code Pro">       //TV is already in Off state.Again Off button is pressed.</font></div><div><font face="Source Code Pro">       tv.pressOffButton();</font></div><div><font face="Source Code Pro">       //TV is already in Off state.Again Mute button is pressed.</font></div><div><font face="Source Code Pro">       tv.pressMuteButton();</font></div><div><font face="Source Code Pro">       //Making the TV on</font></div><div><font face="Source Code Pro">       tv.pressOnButton();</font></div><div><font face="Source Code Pro">       //TV is already in On state.Again On button is pressed.</font></div><div><font face="Source Code Pro">       tv.pressOnButton();</font></div><div><font face="Source Code Pro">       //Putting the TV in Mute mode</font></div><div><font face="Source Code Pro">       tv.pressMuteButton();</font></div><div><font face="Source Code Pro">       //TV is already in Mute mode.Again Mute button is pressed.</font></div><div><font face="Source Code Pro">       tv.pressMuteButton();</font></div><div><font face="Source Code Pro">       //Making the TV off</font></div><div><font face="Source Code Pro">       tv.pressOffButton();</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">Can you elaborate how this pattern is useful with another real-world scenario?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>Psychologists repeatedly documented the fact that human beings can <span style="font-style: italic;">perform their best when they are in a relaxed mode and they are free of tension</span> but in the reverse scenario, when their minds are filled with tension, they cannot produce great results. That is why psychologists always suggest that you should work in relaxed mood. You can relate this simple philosophy with the TV illustration. If the TV is on, it can entertain you; if it is off, it cannot. Right? <span style="font-style: italic;">So, if you want to design similar kinds of behavior changes of an object when it’s internal state changes, this pattern is useful.</span></div><div>Apart from this example, you can consider the scenario where a customer buys an online ticket and in some later phase he/she cancels it. The refund amount may vary with different conditions; for example, the number of days before you can cancel the ticket.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">In this example, you have considered only three states of a TV: On, Off, or Mute. There are many other states, for example, there may be a state that deals with connection issues or display conditions. Why have you ignored those?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>The straightforward answer is to represent simplicity. If the number of states increases significantly in the system, then it becomes difficult to maintain the system (and it is one of the key challenges associated with this design pattern). But if you understand this implementation, you can easily add any states you want.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">I noticed that the GoF represented a similar structure for both the state pattern and the strategy pattern in their famous book. I am confused to see that.</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>Yes, the structures are similar, but you need to note that the intents are different. Apart from this key distinction, you can simply think like this: with a strategy pattern provides a better alternative to subclassing. On the other hand, in a state design pattern, different types of behaviors can be encapsulated in a state object and the context is delegated to any of these states. When a context’s internal states change, its behavior also changes.</div><div>State patterns can also help us avoid lots of if conditions in some contexts. (Consider our example once again. If the TV is in the Off state, it cannot go to the Mute state. From this state, it can move to the On state only.) So, if you do not like state design pattern, you may need to code like this for a On button press.</div><div><font face="Source Code Pro"><br/></font></div><div><font face="Source Code Pro">class TV</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">//Some code before</font></div><div><font face="Source Code Pro">public void pressOnButton()</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">if(currentState==Off )</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">System.<span style="font-style: italic; font-weight: bold;">out</span>.println (&quot; You pressed Onbutton. Going from Off to OnState&quot;);</font></div><div><font face="Source Code Pro">//Do some operations</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">if(currentState==On )</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro"> System.<span style="font-style: italic; font-weight: bold;">out</span>.println (&quot; You pressed On button. TV is already  in On state&quot;);</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">//TV presently is in mute mode</font></div><div><font face="Source Code Pro">else</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro"> System.<span style="font-style: italic; font-weight: bold;">out</span>.println (&quot; You pressed On button . Going from Mute mode to On State&quot;);</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">//Do some operations</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro"><br/></font></div><div>Notice that you need to repeat these checks for different kinds of button presses. (For example, for the pressOffButton() and pressMuteButton() methods, you need to repeat these checks and perform accordingly.)</div><div>If you do not think in terms of states, if your code base grows, maintenance becomes difficult.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">How are you supporting the open-close principle in our implementation?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>Each of these TV states are closed for modification, but you can add brand-new states to the TV class.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">What are the common characteristics between the strategy pattern and the state pattern?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R. </b>Both can promote composition and delegation.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">It appears to me that these state objects are acting like singletons. Is this correct?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R:  </b>Yes. Most times they act in this way.</div></td></tr></tbody></table><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="width: 846px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">D:   can you show a different implementation of the state pattern ?</span></div></td></tr><tr><td style="width: 846px; padding: 8px; border: 1px solid;"><div>Here is the modified implementation.</div><div><font face="Source Code Pro"><br/></font></div><div><font face="Source Code Pro">package jdp2e.state.modified.demo;</font></div><div><font face="Source Code Pro">interface PossibleStates</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   void pressOnButton();</font></div><div><font face="Source Code Pro">   void pressOffButton();</font></div><div><font face="Source Code Pro">   void pressMuteButton();</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class Off implements  PossibleStates</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   TV tvContext;</font></div><div><font face="Source Code Pro">   //Initially we'll start from Off state</font></div><div><font face="Source Code Pro">   public Off(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       //System.out.println(&quot; TV is Off now.&quot;);</font></div><div><font face="Source Code Pro">       this.tvContext = context;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //Users can press any of these buttons at this state-On, Off or Mute</font></div><div><font face="Source Code Pro">   //TV is Off now, user is pressing On button</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOnButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot; You pressed On button. Going from Off to On state&quot;);</font></div><div><font face="Source Code Pro">       tvContext.setCurrentState(tvContext.getOnState());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(tvContext.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //TV is Off already, user is pressing Off button again</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOffButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot; You pressed Off button. TV is already in Off state&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //TV is Off now, user is pressing Mute button</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressMuteButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot; You pressed Mute button.TV is already in Off state, so Mute operation will not work.&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public String toString()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return &quot;\t**TV is switched off now.**&quot;;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class On implements PossibleStates</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   TV tvContext;</font></div><div><font face="Source Code Pro">   public On(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       //System.out.println(&quot; TV is On now.&quot;);</font></div><div><font face="Source Code Pro">       this.tvContext = context;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //Users can press any of these buttons at this state-On, Off or Mute</font></div><div><font face="Source Code Pro">   //TV is On already, user is pressing On button again</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOnButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed On button. TV is already in On state.&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //TV is On now, user is pressing Off button</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOffButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot; You pressed Off button.Going from On to Off state.&quot;);</font></div><div><font face="Source Code Pro">       tvContext.setCurrentState(tvContext.getOffState());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(tvContext.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //TV is On now, user is pressing Mute button</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressMuteButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed Mute button.Going from On to Mute mode.&quot;);</font></div><div><font face="Source Code Pro">       tvContext.setCurrentState(tvContext.getMuteState());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(tvContext.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public String toString()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return &quot;\t**TV is switched on now.**&quot;;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class Mute implements PossibleStates</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   TV tvContext;</font></div><div><font face="Source Code Pro">   public Mute(TV context)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       this.tvContext = context;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //Users can press any of these buttons at this state-On, Off or Mute</font></div><div><font face="Source Code Pro">   //TV is in mute, user is pressing On button</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOnButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed On button.Going from Mute mode to On state.&quot;);</font></div><div><font face="Source Code Pro">       tvContext.setCurrentState(tvContext.getOnState());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(tvContext.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //TV is in mute, user is pressing Off button</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressOffButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;You pressed Off button. Going from Mute mode to Off state.&quot;);</font></div><div><font face="Source Code Pro">       tvContext.setCurrentState(tvContext.getOffState());</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(tvContext.getCurrentState().toString());</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   //TV is in mute already, user is pressing mute button again</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void pressMuteButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot; You pressed Mute button.TV is already in Mute mode.&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public String toString()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return &quot;\t**TV is silent(mute) now**&quot;;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class TV</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   private PossibleStates currentState;</font></div><div><font face="Source Code Pro">   private PossibleStates onState;</font></div><div><font face="Source Code Pro">   private PossibleStates offState;</font></div><div><font face="Source Code Pro">   private PossibleStates muteState;</font></div><div><font face="Source Code Pro">   public TV()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       onState=new On(this);</font></div><div><font face="Source Code Pro">       offState=new Off(this);</font></div><div><font face="Source Code Pro">       muteState=new Mute(this);</font></div><div><font face="Source Code Pro">       setCurrentState(offState);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public PossibleStates getCurrentState()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return currentState;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void setCurrentState(PossibleStates currentState)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       this.currentState = currentState;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void pressOffButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       currentState.pressOffButton();</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void pressOnButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       currentState.pressOnButton();</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void pressMuteButton()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       currentState.pressMuteButton();</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public PossibleStates getOnState()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return onState;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public PossibleStates getOffState()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return offState;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public PossibleStates getMuteState()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return muteState;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">//Client</font></div><div><font face="Source Code Pro">public class StatePatternAlternativeImplementation {</font></div><div><font face="Source Code Pro">   public static void main(String[] args) {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;***State Pattern Alternative Implementation Demo***\n&quot;);</font></div><div><font face="Source Code Pro">       //Initially TV is Off.</font></div><div><font face="Source Code Pro">       TV tv = new TV();</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;User is pressing buttons in the following sequence:&quot;);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;Off-&gt;Mute-&gt;On-&gt;On-&gt;Mute-&gt;Mute-&gt;Off\n&quot;);</font></div><div><font face="Source Code Pro">       //TV is already in Off state.Again Off button is pressed.</font></div><div><font face="Source Code Pro">       tv.pressOffButton();</font></div><div><font face="Source Code Pro">       //TV is already in Off state.Again Mute button is pressed.</font></div><div><font face="Source Code Pro">       tv.pressMuteButton();</font></div><div><font face="Source Code Pro">       //Making the TV on</font></div><div><font face="Source Code Pro">       tv.pressOnButton();</font></div><div><font face="Source Code Pro">       //TV is already in On state.Again On button is pressed.</font></div><div><font face="Source Code Pro">       tv.pressOnButton();</font></div><div><font face="Source Code Pro">       //Putting the TV in Mute mode</font></div><div><font face="Source Code Pro">       tv.pressMuteButton();</font></div><div><font face="Source Code Pro">       //TV is already in Mute mode.Again Mute button is pressed.</font></div><div><font face="Source Code Pro">       tv.pressMuteButton();</font></div><div><font face="Source Code Pro">       //Making the TV off</font></div><div><font face="Source Code Pro">       tv.pressOffButton();</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">Can you avoid the use of “contexts” in the method parameters. For example, can you avoid them in the following statements?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>If you do not want to use the context parameter like this, you may need to modify the implementation. To give a quick overview, I am presenting the modified Package Explorer view with a modified implementation only.</div><div>One of the key changes in the following implementation can be seen in the class TV. The TV() constructor is initialized with all possible state objects, which are used for the change of states in later phases. The getter methods are invoked for this purpose. Consider the following implementation.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">In these implementations, TV is a concrete class. Why are you not programming to interface in this case?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R:  </b>I assume that the TV class is not going to change, and so I ignored that part to reduce some code size of the program. But yes, you can always start from an interface in which you can define the contracts.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   </span><span style="font-weight: bold;">What are the pros and cons of a state design pattern?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b><span style="font-weight: bold;">Pros</span></div><ul><li><div>You have already seen that following the open/close principle, you can easily add new states and new behaviors. Also, a state behavior can be extended without hassle. For example, in this implementation, you can add a new state and a new behavior for a TV class without changing the TV class itself.</div></li><li><div>Reduces the use of if-else statements (i.e., conditional complexity is reduced. (Refer to the answer in question 3).</div></li></ul><div><span style="font-weight: bold;">Cons</span></div><ul><li><div>The state pattern is also known as <span style="font-style: italic;">objects for states</span>. So, you can assume that more states need more codes, and the obvious side effect is difficult maintenance for you.</div></li></ul></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">D:   In the TV class constructor, you are initializing the TV with an Off state. So, can both the states and the context class trigger the state transitions?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>Yes.</div></td></tr></tbody></table><div><br/></div></div></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 