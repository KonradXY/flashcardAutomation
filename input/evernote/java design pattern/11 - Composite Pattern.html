<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308716 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="458"/>

<div>
<span><div><h2>11 - Composite Pattern</h2><div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="width: 846px; padding: 8px; border: 1px solid;"><div>D:    can you give the gof definition of the composite pattern ?</div></td></tr><tr><td style="width: 846px; padding: 8px; border: 1px solid;"><div>R: Compose objects into tree structures to represent part-whole hierarchies. Composite lets clients treat individual objects and compositions of objects uniformly.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:    Can you give an example of the composite pattern</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R: To help you understand this concept, I will start with an example. Consider a shop that sells different kinds of dry fruits and nuts; let’s say cashews, dates, and walnuts. Each of these items is associated with a certain price. Let’s assume that you can purchase any of these individual items or you can purchase “gift packs” (or boxed items) that contain different items. In this case, the cost of a packet is the sum of its component parts. The composite pattern is useful in a similar situation, where you treat both the individual parts and the combination of the parts in the same way so that you can process them uniformly.</div><div>This pattern is useful to represent part-whole hierarchies of objects. In object-oriented programming, a composite is an object with a composition of one-or-more similar objects, where each of these objects has similar functionalities. (This is also known as a “has-a” relationship among objects). The usage of this pattern is very common in a tree-like data structure. If you can apply it properly, you do not need to discriminate between a branch and the leaf-nodes. You can achieve two key goals with this pattern.</div><ul><li><div>You can compose objects into a tree structure to represent a part-whole hierarchy.</div></li><li><div>You can access both the composite objects (branches) and the individual objects (leaf-nodes) uniformly. As a result, you can reduce the complexity of codes and at the same time, you make your application less error prone.</div></li></ul><div><br/></div><div style="text-align: center;"><img src="11 - Composite Pattern_files/Image.jpg" type="image/jpeg" data-filename="Image.jpg" width="486"/></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:    can you show an implementation ?</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R: </div><div>Here is the implementation.<br/></div><div><br/></div><div><font face="Source Code Pro">package <a href="http://jdp2e.composite.demo%3B/">jdp2e.composite.demo;</a></font></div><div><font face="Source Code Pro">import java.util.ArrayList;</font></div><div><font face="Source Code Pro">import java.util.List;</font></div><div><font face="Source Code Pro">interface IEmployee</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   void printStructures();</font></div><div><font face="Source Code Pro">   int getEmployeeCount();</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class CompositeEmployee implements IEmployee</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   //private static int employeeCount=0;</font></div><div><font face="Source Code Pro">   private int employeeCount=0;</font></div><div><font face="Source Code Pro">   private String name;</font></div><div><font face="Source Code Pro">   private String dept;</font></div><div><font face="Source Code Pro">   //The container for child objects</font></div><div><font face="Source Code Pro">   private List&lt;IEmployee&gt; controls;</font></div><div><font face="Source Code Pro">   //Constructor</font></div><div><font face="Source Code Pro">   public CompositeEmployee(String name, String dept)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       this.name = name;</font></div><div><font face="Source Code Pro">       this.dept = dept;</font></div><div><font face="Source Code Pro">       controls = new ArrayList&lt;IEmployee&gt;();</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void addEmployee(IEmployee e)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       controls.add(e);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void removeEmployee(IEmployee e)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       controls.remove(e);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void printStructures()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\t&quot; + this.name + &quot; works in  &quot; + this.dept);</font></div><div><font face="Source Code Pro">       for(IEmployee e: controls)</font></div><div><font face="Source Code Pro">       {</font></div><div><font face="Source Code Pro">           e.printStructures();</font></div><div><font face="Source Code Pro">       }</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public int getEmployeeCount()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       employeeCount=controls.size();</font></div><div><font face="Source Code Pro">       for(IEmployee e: controls)</font></div><div><font face="Source Code Pro">       {</font></div><div><font face="Source Code Pro">           employeeCount+=e.getEmployeeCount();</font></div><div><font face="Source Code Pro">       }</font></div><div><font face="Source Code Pro">       return employeeCount;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class Employee implements IEmployee</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   private String name;</font></div><div><font face="Source Code Pro">   private String dept;</font></div><div><font face="Source Code Pro">   private int employeeCount=0;</font></div><div><font face="Source Code Pro">   //Constructor</font></div><div><font face="Source Code Pro">   public Employee(String name, String dept)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       this.name = name;</font></div><div><font face="Source Code Pro">       this.dept = dept;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void printStructures()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\t\t&quot;+this.name + &quot; works in  &quot; + this.dept);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public int getEmployeeCount()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return employeeCount;//0</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class CompositePatternExample {</font></div><div><font face="Source Code Pro">   /**Principal is on top of college.</font></div><div><font face="Source Code Pro">    *HOD -Maths and Comp. Sc directly reports to him</font></div><div><font face="Source Code Pro">    *Teachers of Computer Sc. directly reports to HOD-CSE</font></div><div><font face="Source Code Pro">    *Teachers of Mathematics directly reports to HOD-Maths</font></div><div><font face="Source Code Pro">    */</font></div><div><font face="Source Code Pro">   public static void main(String[] args) {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;***Composite Pattern Demo ***&quot;);</font></div><div><font face="Source Code Pro">       //2 teachers other than HOD works in Mathematics department</font></div><div><font face="Source Code Pro">       Employee mathTeacher1 = new Employee(&quot;Math Teacher-1&quot;,&quot;Maths&quot;);</font></div><div><font face="Source Code Pro">       Employee mathTeacher2 = new Employee(&quot;Math Teacher-2&quot;,&quot;Maths&quot;);</font></div><div><font face="Source Code Pro">       //teachers other than HOD works in Computer Sc. Department</font></div><div><font face="Source Code Pro">       Employee cseTeacher1 = new Employee(&quot;CSE Teacher-1&quot;, &quot;Computer Sc.&quot;);</font></div><div><font face="Source Code Pro">       Employee cseTeacher2 = new Employee(&quot;CSE Teacher-2&quot;, &quot;Computer Sc.&quot;);</font></div><div><font face="Source Code Pro">       Employee cseTeacher3 = new Employee(&quot;CSE Teacher-3&quot;, &quot;Computer Sc.&quot;);</font></div><div><font face="Source Code Pro">       //The College has 2 Head of Departments-One from Mathematics, One //from Computer Sc.</font></div><div><font face="Source Code Pro">       CompositeEmployee hodMaths = new CompositeEmployee(&quot;Mrs.S.Das(HOD-Maths)&quot;,&quot;Maths&quot;);</font></div><div><font face="Source Code Pro">       CompositeEmployee hodCompSc = new CompositeEmployee(&quot;Mr. V.Sarcar(HOD-CSE)&quot;, &quot;Computer Sc.&quot;);</font></div><div><font face="Source Code Pro">       //Principal of the college</font></div><div><font face="Source Code Pro">       CompositeEmployee principal = new CompositeEmployee(&quot;Dr.S.Som(Principal)&quot;,&quot;Planning-Supervising-Managing&quot;);</font></div><div><font face="Source Code Pro">       //Teachers of Mathematics directly reports to HOD-Maths</font></div><div><font face="Source Code Pro">       hodMaths.addEmployee(mathTeacher1);</font></div><div><font face="Source Code Pro">       hodMaths.addEmployee(mathTeacher2);</font></div><div><font face="Source Code Pro">       //Teachers of Computer Sc. directly reports to HOD-CSE</font></div><div><font face="Source Code Pro">       hodCompSc.addEmployee(cseTeacher1);</font></div><div><font face="Source Code Pro">       hodCompSc.addEmployee(cseTeacher2);</font></div><div><font face="Source Code Pro">       hodCompSc.addEmployee(cseTeacher3);</font></div><div><font face="Source Code Pro">       /*Principal is on top of college.HOD -Maths and Comp. Sc directly reports to him*/</font></div><div><font face="Source Code Pro">       principal.addEmployee(hodMaths);</font></div><div><font face="Source Code Pro">       principal.addEmployee(hodCompSc);</font></div><div><font face="Source Code Pro">       /*Printing the leaf-nodes and branches in the same way i.e.</font></div><div><font face="Source Code Pro">        in each case, we are calling PrintStructures() method</font></div><div><font face="Source Code Pro">        */</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\n Testing the structure of a Principal object&quot;);</font></div><div><font face="Source Code Pro">       //Prints the complete structure</font></div><div><font face="Source Code Pro">       principal.printStructures();</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;At present Principal has control over &quot;+ principal.getEmployeeCount()+ &quot; number of employees.&quot;);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\n Testing the structure of a HOD-CSE object:&quot;);</font></div><div><font face="Source Code Pro">       //Prints the details of Computer Sc, department</font></div><div><font face="Source Code Pro">       hodCompSc.printStructures();</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;At present HOD-CSE has control over &quot;+ hodCompSc.getEmployeeCount()+ &quot; number of employees.&quot;);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\n Testing the structure of a HOD-Maths object:&quot;);</font></div><div><font face="Source Code Pro">       //Prints the details of Mathematics department</font></div><div><font face="Source Code Pro">       hodMaths.printStructures();</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;At present HOD-Maths has control over &quot;+ hodMaths.getEmployeeCount()+ &quot; number of employees.&quot;);</font></div><div><font face="Source Code Pro">       //Leaf node</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\n Testing the structure of a leaf node:&quot;);</font></div><div><font face="Source Code Pro">       mathTeacher1.printStructures();</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;At present Math Teacher-1 has control over &quot;+ mathTeacher1.getEmployeeCount()+ &quot; number of employees.&quot;);</font></div><div><font face="Source Code Pro">       /*Suppose, one computer teacher is leaving now</font></div><div><font face="Source Code Pro">        from the organization*/</font></div><div><font face="Source Code Pro">       hodCompSc.removeEmployee(cseTeacher2);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\n After CSE Teacher-2 resigned, the organization has following members:&quot;);</font></div><div><font face="Source Code Pro">       principal.printStructures();</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;At present Principal has control over &quot;+ principal.getEmployeeCount()+ &quot; number of employees&quot;);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;At present HOD-CSE has control over &quot;+ hodCompSc.getEmployeeCount()+ &quot; number of employees&quot;);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;At present HOD-Maths has control over &quot;+ hodMaths.getEmployeeCount()+ &quot; number of employees&quot;);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:    <span style="font-weight: bold;">What are the</span> <span style="font-weight: bold;">advantages</span> <span style="font-weight: bold;">of using composite design patterns?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R:</div><ul><li><div>In a tree-like structure, you can treat both the composite objects (branches) and the individual objects (leaf-nodes) uniformly. Notice that in this example, I have used two common methods: printStructures() and getEmployeeCount() to print the structure and get the employee count from both the composite object structure (principal or HODs) and the single object structure (i.e., leaf nodes like Math Teacher 1.)</div></li><li><div>It is very common to implement a part-whole hierarchy using this design pattern.</div></li><li><div>You can easily add a new component to an existing architecture or delete an existing component from your architecture.</div></li></ul></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:    <span style="font-weight: bold;">What are the</span> <span style="font-weight: bold;">challenges</span> <span style="font-weight: bold;">associated with using composite design patterns?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R:</div><ul><li><div>If you want to maintain the ordering of child nodes (e.g., if parse trees are represented as components), you may need to use additional efforts.</div></li><li><div>If you are dealing with immutable objects, you cannot simply delete those.</div></li><li><div>You can easily add a new component but that kind of support can cause maintenance overhead in the future. Sometimes, you want to deal with a composite object that has special components. This kind of constraint can cause additional development costs because you may need to implement a dynamic checking mechanism to support the concept.</div></li></ul></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:    <span style="font-weight: bold;">In this example, you have used list data structure</span> <span style="font-weight: bold;">. But I prefer to use other data structures. Is this okay?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R: Absolutely. There is no universal rule. You are free to use your preferred data structure. GoF confirmed that it is not necessary to use any general-purpose data structure<span style="font-style: italic;">.</span></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:    <span style="font-weight: bold;">How can you connect the iterator design pattern to a composite design pattern?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>Go through our example once again. If you want to examine composite object architecture, you may need to iterate over the objects. In other words, if you want to do special activities with branches, you may need to iterate over its leaf nodes and non-leaf nodes. Iterator patterns are often used with composite patterns.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:    <span style="font-weight: bold;">In the interface of your implementation, you defined only two methods: printStructures()</span> <span style="font-weight: bold;">and getEmployeeCount()</span> <span style="font-weight: bold;">. But you are using other methods for the addition and removal of objects in the Composite class (CompositeEmployee). Why didn’t you put these methods in the interface?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R: Nice observation. GoF discussed this. Let’s look at what happens if you put the addEmployee (…) and removeEmployee (…) methods in the interface. The leaf nodes need to implement the addition and removal operations. But will it be meaningful in this case? The obvious answer is no. It may appear that you lose transparency, but I believe that you have more safety because I have blocked the meaningless operations in the leaf nodes. This is why the GoF mentioned that this kind of decision involves a trade-off between safety and transparency.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:    <span style="font-weight: bold;">I want to use an abstract class instead of an interface. Is this allowed?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>In most of the cases, the simple answer is yes. But you need to understand the difference between an abstract class and an interface. In a typical scenario, you find one of them more useful than the other one. Since I am presenting only simple and easy to understand examples, you may not see much difference between the two. Particularly in this example, if I use the abstract class instead of the interface, I may put a default implementation of getEmployeeCount() in the abstract class definition. Although you can still argue that with Java’s default keyword, you could achieve the same, as in the following:</div><div><br/></div><div><font face="Source Code Pro">interface IEmployee</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   void printStructures();</font></div><div><font face="Source Code Pro">   //int getEmployeeCount();</font></div><div><font face="Source Code Pro">   default public int getEmployeeCount()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return 0;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div></td></tr></tbody></table><div><br/></div></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 