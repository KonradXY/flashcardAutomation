<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308716 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="472"/>

<div>
<span><div><h2><span style="font-weight: bold;">14 - Observer pattern</span></h2><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="width: 846px; padding: 8px; border: 1px solid;"><div>D:   what is the gof definition of the observer pattern ?</div></td></tr><tr><td style="width: 846px; padding: 8px; border: 1px solid;"><div>R: Define a one-to-many dependency between objects so that when one object changes state, all its dependents are notified and updated automatically.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:   can you show the uml diagram of the observer pattern ?</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R: In this pattern, there are many observers (objects) that are observing a particular subject (also an object). Observers register themselves to a subject to get a notification when there is a change made inside that subject. When they lose interest of the subject, they simply unregister from the subject. It is also referred to as the <span style="font-style: italic;">publish-subscribe pattern</span> . The whole idea can be summarized as follows: <span style="font-style: italic;">Using this pattern, an object (subject) can send notifications to multiple observers (a set of objects) at the same time.</span></div><div style="text-align: center;"><img src="14  - Observer Pattern_files/Image.jpg" type="image/jpeg" data-filename="Image.jpg" width="566"/></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:   can you show an implementation of the observer pattern ?</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><font face="Source Code Pro">R: </font></div><div><font face="Source Code Pro">package jdp2e.observer.demo;</font></div><div><font face="Source Code Pro">import java.util.*;</font></div><div><font face="Source Code Pro">interface Observer</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   void update(int updatedValue);</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class ObserverType1 implements Observer</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   String nameOfObserver;</font></div><div><font face="Source Code Pro">   public ObserverType1(String name)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       this.nameOfObserver = name;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void update(int updatedValue)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println( nameOfObserver+&quot; has received an alert: Updated myValue in Subject is: &quot;+ updatedValue);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class ObserverType2 implements Observer</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   String nameOfObserver;</font></div><div><font face="Source Code Pro">   public ObserverType2(String name)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       this.nameOfObserver = name;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void update(int updatedValue)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println( nameOfObserver+&quot; has received an alert: The current value of myValue in Subject is: &quot;+ updatedValue);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">interface SubjectInterface</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   void register(Observer anObserver);</font></div><div><font face="Source Code Pro">   void unregister(Observer anObserver);</font></div><div><font face="Source Code Pro">   void notifyRegisteredUsers(int notifiedValue);</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">class Subject implements SubjectInterface</font></div><div><font face="Source Code Pro">{</font></div><div><font face="Source Code Pro">   private int flag;</font></div><div><font face="Source Code Pro">   public int getFlag()</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       return flag;</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   public void setFlag(int flag)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       this.flag = flag;</font></div><div><font face="Source Code Pro">       //Flag value changed. So notify registered users/observers.</font></div><div><font face="Source Code Pro">       notifyRegisteredUsers(flag);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   List&lt;Observer&gt; observerList = new ArrayList&lt;Observer&gt;();</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void register(Observer anObserver) {</font></div><div><font face="Source Code Pro">       observerList.add(anObserver);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void unregister(Observer anObserver) {</font></div><div><font face="Source Code Pro">       observerList.remove(anObserver);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">   @Override</font></div><div><font face="Source Code Pro">   public void notifyRegisteredUsers(int updatedValue)</font></div><div><font face="Source Code Pro">   {</font></div><div><font face="Source Code Pro">       for (Observer observer : observerList)</font></div><div><font face="Source Code Pro">           observer.update(updatedValue);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div><div><font face="Source Code Pro">public class ObserverPatternExample {</font></div><div><font face="Source Code Pro">   public static void main(String[] args) {</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot; ***Observer Pattern Demo***\n&quot;);</font></div><div><font face="Source Code Pro">       //We have 3 observers- 2 of them are ObserverType1, 1 of them is of //ObserverType2</font></div><div><font face="Source Code Pro">       Observer myObserver1 = new ObserverType1(&quot;Roy&quot;);</font></div><div><font face="Source Code Pro">       Observer myObserver2 = new ObserverType1(&quot;Kevin&quot;);</font></div><div><font face="Source Code Pro">       Observer myObserver3 = new ObserverType2(&quot;Bose&quot;);</font></div><div><font face="Source Code Pro">       Subject subject = new Subject();</font></div><div><font face="Source Code Pro">       //Registering the observers-Roy,Kevin,Bose</font></div><div><font face="Source Code Pro">       subject.register(myObserver1);</font></div><div><font face="Source Code Pro">       subject.register(myObserver2);</font></div><div><font face="Source Code Pro">       subject.register(myObserver3);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot; Setting Flag = 5 &quot;);</font></div><div><font face="Source Code Pro">       subject.setFlag(5);</font></div><div><font face="Source Code Pro">       //Unregistering an observer(Roy))</font></div><div><font face="Source Code Pro">       subject.unregister(myObserver1);</font></div><div><font face="Source Code Pro">       //No notification this time Roy. Since it is unregistered.</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\n Setting Flag = 50 &quot;);</font></div><div><font face="Source Code Pro">       subject.setFlag(50);</font></div><div><font face="Source Code Pro">       //Roy is registering himself again</font></div><div><font face="Source Code Pro">       subject.register(myObserver1);</font></div><div><font face="Source Code Pro">       System.<span style="font-style: italic;">out</span>.println(&quot;\n Setting Flag = 100 &quot;);</font></div><div><font face="Source Code Pro">       subject.setFlag(100);</font></div><div><font face="Source Code Pro">   }</font></div><div><font face="Source Code Pro">}</font></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:   <span style="font-weight: bold;">If I have only one observer, then I may not need to set up the interface. Is this correct?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>Yes. But if you want to follow the pure object-oriented programming guidelines, programming to an interface/abstract class is always considered a better practice. So, you should prefer interfaces (or abstract classes) over concrete classes. Also, usually, you have multiple observers, and you want them to implement the methods in a systematic manner that follows the contract. You get benefit from this kind of design.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:   <span style="font-weight: bold;">Can you have different types of observers in the same application?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>R: Yes. This is why I have played with three observers from two different classes. But you should not feel that for each observer; you need to create a different class.</div><div>Consider a real-world scenario. When a company releases or updates new software, the company business partners and the customers who purchased the software get notifications. In this case, the business partners and the customers are two different types of observers.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:   </div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><span style="font-weight: bold;">Can I add or remove observers at runtime?</span></div><div>Yes. At the beginning our program, Roy registered to get notifications; then he unregistered and later reregistered.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:   <span style="font-weight: bold;">It appears that there are similarities between the observer pattern and the chain of responsibility pattern. Is this correct?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>In an observer pattern, all registered users get notifications at the same time, but in a chain of responsibility pattern, objects in the chain are notified one by one, and this process continues until the object fully handles the notification.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:  <span style="font-weight: bold;">This model supports one-to-many relationships. Is this correct?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>Yes. Since a subject can send notifications to multiple observers, this kind of dependency is clearly depicting a one-to-many relationship.</div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:   <span style="font-weight: bold;">If you already have these ready-made constructs, why are you writing your own code?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R: </b>Changing the ready-made constructs to your preference is not always easy. In many cases, you cannot change the built-in functionalities at all. When you try to implement the concept yourself, you may have a better understanding of how to use those ready-made constructs.</div><div>Consider some typical scenarios.</div><ul><li><div>In Java, Observable is a concrete class. It does not implement an interface. So, you can’t create your own implementation that works with Java’s built-in Observer API.</div></li><li><div>Java does not allow multiple inheritance. So, when you have to extend the Observable class, you have to keep in mind the restriction. This may limit the reuse potential.</div></li><li><div>The signature of the setChanged method in an Observable is as follows: protected void setChanged(). That means to use it, you need to subclass Observable class. This violates one of the key design principles, which basically says to prefer composition over inheritance.</div></li></ul></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 846px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div>D:   <span style="font-weight: bold;">What are the key challenges associated with an observer pattern?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 846px; padding: 8px;"><div><b>R:</b></div><ul><li><div>Undoubtedly, memory leak is the greatest concern when you deal with any event-based mechanism. An automatic garbage collector may not always help you in this context. You can consider such a case where the deregister/unregister operations are not performed properly.</div></li><li><div>The order of notification is not dependable.</div></li><li><div>Java’s built-in support for the observer pattern has some key restrictions, which I discussed earlier. One of them forces you to prefer inheritance over composition, so it clearly violates one of the key design principles that prefers the opposite.</div></li></ul></td></tr></tbody></table><div><br/></div></div></div><div><br/></div></span>
</div></body></html> 