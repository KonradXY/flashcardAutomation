<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308716 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="398"/>

<div>
<span><div><div><h2><span style="font-weight: bold;">1 - Singleton</span></h2></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 868px;"></col></colgroup><tbody><tr><td style="width: 868px; padding: 8px; border: 1px solid;"><div><span style="font-size: 10pt;">D: what is the gof definition of a singleton ?  What is the concept behind a singleton ? Why this approach can be necessary ? </span></div></td></tr><tr><td style="width: 868px; padding: 8px; border: 1px solid;"><div><span style="font-size: 10pt;">R: Ensure a class only has one instance, and provide a global point of access to it. A class cannot have multiple instances. Once created, the next time onward, you use only the existing instance. </span></div></td></tr></tbody></table><div><div><font style="font-size: 10pt;"><br/></font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 868px;"></col></colgroup><tbody><tr><td style="width: 868px; padding: 8px; border: 1px solid;"><div><span style="font-size: 10pt; font-weight: bold;">D:</span><span style="font-size: 10pt;">    Can you describe the key characteristic of a singleton ? </span></div></td></tr><tr><td style="width: 868px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">R:</span>     </div><ul><li><div>The constructor is private, so you cannot instantiate the Singleton class(Captain) outside. It helps us to refer the only instance that can exist in the system, and at the same time, you restrict the additional object creation of the Captain class.</div></li><li><div>The private constructor also ensures that the Captain class cannot be extended. So, subclasses cannot misuse the concept.</div></li><li><div>I used the “synchronized” keyword. So, multiple threads cannot involve in the instantiation process at the same time. I am forcing each thread to wait its turn to get the method, so thread- safety is ensured. But synchronization is a costly operation and once the instance is created, it is an additional overhead. (I’ll discuss some alternative methods in the upcoming sections, but each of them has its own pros and cons).</div></li></ul><div><br/></div><div style="text-align: center;"><img src="1 - Singleton Pattern_files/Image.jpg" type="image/jpeg" data-filename="Image.jpg" width="483"/></div></td></tr></tbody></table><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 868px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt;">D: can you give an implementation of a singleton ?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt; font-weight: bold;">R:</span> <span style="font-size: 10pt;">Here’s the implementation.</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">package jdp2e.singleton.demo;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">final class Captain</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">{</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private static Captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   //We make the constructor private to prevent the use of &quot;new&quot;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private Captain() {    }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static synchronized Captain getCaptain()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       // Lazy initialization</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       if (</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">== null)</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">= new Captain();</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;New captain is elected for your team.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       else</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.print(&quot;You already have a captain for your team.&quot;);</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic; font-weight: bold;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;Send him for the toss.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       return</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">// We cannot extend Captain class. The constructor is private in this case.</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">//class B extends Captain{}// error</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">public class SingletonPatternExample {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static void main(String[] args) {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;***Singleton Pattern Demo***\n&quot;);</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;Trying to make a captain for your team:&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       //Constructor is private.We cannot use &quot;new&quot; here.</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       //Captain c3 = new Captain();//error</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       Captain captain1 = Captain.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">getCaptain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">();</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;Trying to make another captain for your team:&quot;);</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       Captain captain2 = Captain.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">getCaptain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">();</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       if (captain1 == captain2)</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;captain1 and captain2 are same instance.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div></td></tr></tbody></table><div><font style="font-size: 10pt;"><br/></font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 868px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt; font-weight: bold;">D:    </span><span style="font-size: 10pt;">How can you prevent subclassing in a singleton ?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt;">R:     Subclassing can be prevented in various ways. Yes, in this example, since the constructor is already marked with the “private” keyword, it was not needed. But if you make the Captain class final, as shown in the example, that approach is considered a better practice. It is effective when you consider a nested class. For example, let’s modify the private constructor body to examine the number of instances (of the Captain class) created. Let’s further assume that in the preceding example, you have a</span> <span style="font-size: 10pt; font-style: italic;">non-static nested class</span> <span style="font-size: 10pt;">(called</span> <span style="font-size: 10pt; font-style: italic;">inner class</span> <span style="font-size: 10pt;">in Java) like the following. (All changes are shown in bold.)</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">//final class Captain</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">class Captain</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">{</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private static Captain captain;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   //We make the constructor private to prevent the use of &quot;new&quot;</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">static int numberOfInstance=0;</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private Captain()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">numberOfInstance++;</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">System.out.println(&quot;Number of instances at this moment=&quot;+ numberOfInstance);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static synchronized Captain getCaptain()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       // Lazy initialization</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       if (captain == null)</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           captain = new Captain();</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           System.out.println(&quot;New captain is elected for your team.&quot;);</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       else</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           System.out.print(&quot;You already have a captain for your team.&quot;);</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           System.out.println(&quot;Send him for the toss.&quot;);</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       return captain;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   </span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">//A non-static nested class (inner class)</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;"> </span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">public class CaptainDerived extends Captain</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;"> </span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">{</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   </span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">//Some code</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;"> </span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">}</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">Now add an another line of code (shown in bold) inside the main() method , as follows.</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">public class SingletonPatternExample {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static void main(String[] args) {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;***Singleton Pattern Demo***\n&quot;);</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;Trying to make a captain for your team:&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       //Constructor is private.We cannot use &quot;new&quot; here.</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       //Captain c3 = new Captain();//error</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       Captain captain1 = Captain.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">getCaptain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">();</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;Trying to make another captain for your team:&quot;);</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       Captain captain2 = Captain.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">getCaptain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">();</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       if (captain1 == captain2)</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;captain1 and captain2 are same instance.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       }</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">Captain.CaptainDerived derived=captain1.new CaptainDerived();</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">Now notice the output.</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">***Singleton Pattern Demo***</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">Trying to make a captain for your team:</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">Number of instances at this moment=1</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">New captain is elected for your team.</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">Trying to make another captain for your team:</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">You already have a captain for your team.Send him for the toss.</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">captain1 and captain2 are same instance.</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">Number of instances at this moment=2</span></div></td></tr></tbody></table><div><font style="font-size: 10pt;"><br/></font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 868px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt; font-weight: bold;">D:    </span><span style="font-size: 10pt;">Can you give an example of a singleton with eager initialization ? </span><span style="font-size: 10pt; font-weight: bold;">What are pros and cons of an eager initialization ?</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt;">R:     Here is a sample implementation of the eager initialization.</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">class Captain</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">{</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   //Early initialization</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private static final Captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">= new Captain();</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   //We make the constructor private to prevent the use of &quot;new&quot;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private Captain()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;A captain is elected for your team.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   /* Global point of access.The method getCaptain() is a public static method*/</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static Captain getCaptain()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;You have a captain for your team.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       return</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">An eager initialization approach has the following pros and cons.</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt; font-weight: bold;">Pros</span></div><ul><li><div><span style="font-size: 10pt;">It is straightforward and cleaner.</span></div></li><li><div><span style="font-size: 10pt;">It is the opposite of lazy initialization but still thread safe.</span></div></li><li><div><span style="font-size: 10pt;">It has a small lag time when the application is in execution mode because everything is already loaded in memory.</span></div></li></ul><div><span style="font-size: 10pt; font-weight: bold;">Cons</span></div><ul><li><div><span style="font-size: 10pt;">The application takes longer to start (compared to lazy initialization) because everything needs to be loaded first. To examine the penalty, let’s add a dummy method (shown in bold) in the Singleton class. Notice that in the main method, I am invoking only this dummy method. Now examine the output.</span></div></li></ul><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">package jdp2e.singleton.questions_answers;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">class Captain</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">{</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   //Early initialization</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private static final Captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">= new Captain();</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   //We make the constructor private to prevent the use of &quot;new&quot;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private Captain()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;A captain is elected for your team.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   /* Global point of access.The method getCaptain() is a public static method*/</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static Captain getCaptain()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;You have a captain for your team.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       return</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">public static void dummyMethod()</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">{</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic; font-weight: bold;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">.println(&quot;It is a dummy method&quot;);</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">}</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">public class EagerInitializationExample {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static void main(String[] args) {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;***Singleton Pattern Demo With Eager Initialization***\n&quot;);</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">Captain.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic; font-weight: bold;">dummyMethod</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">();</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       /*System.out.println(&quot;Trying to make a captain for your team:&quot;);</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       Captain captain1 = Captain.getCaptain();</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.out.println(&quot;Trying to make another captain for your team:&quot;);</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       Captain captain2 = Captain.getCaptain();</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           if (captain1 == captain2)</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">               System.out.println(&quot;captain1 and captain2 are same instance.&quot;);</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           }*/</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">Notice that</span> <span style="font-size: 10pt; font-style: italic;">A captain is elected for your team</span> <span style="font-size: 10pt;">still appears in the output, though you may have no intention to deal with that.</span></div><div><span style="font-size: 10pt;">So, in the preceding situation, an object of the Singleton class is always instantiated. Also, prior to Java 5, there were many issues that dealt with Singleton classes.</span></div></td></tr></tbody></table><div><font style="font-size: 10pt;"><br/></font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 868px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt;">D:    do you know a solution for making a singleton using a nested static helper class ?  What are the advantage of using the static nested class for a singleton ? </span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><h3><span style="font-size: 10pt;">R:    Bill Pugh came up with a different approach using a static nested helper class.</span></h3><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">package jdp2e.singleton.questions_answers;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">class Captain1</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">{</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private Captain1() {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;A captain is elected for your team.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   //Bill Pugh solution</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private static class SingletonHelper{</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       /*Nested class is referenced after getCaptain() is called*/</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       private static final Captain1</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">= new Captain1();</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static Captain1 getCaptain()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       return SingletonHelper.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">;</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   /*public static void dummyMethod()</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.out.println(&quot;It is a dummy method&quot;);</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }  */</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div><div><br/></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;;">This method does not use a synchronization technique and eager initialization. Notice that the SingletonHelper class comes into consideration only when someone invokes the getCaptain() method . And this approach will not create any unwanted output if you just call any dummyMethod() from main(), as with the previous case (to examine the result, you need to uncomment the dummyMethod() body). It is also treated one of the common and standard methods for implementing singletons in Java.</span></div></td></tr></tbody></table><div><font style="font-size: 10pt;"><br/></font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 868px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt; font-weight: bold;">D:     </span><span style="font-size: 10pt;">Can you define a singleton with a double checking locking ? Why the double check locking is advantageous ?</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;"> </span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div><span style="font-size: 10pt; font-weight: bold;">R:</span> <span style="font-size: 10pt;">    Here's the implementation</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">package jdp2e.singleton.questions_answers;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">final class Captain2</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">{</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private static Captain2</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   //We make the constructor private to prevent the use of &quot;new&quot;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   static int</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">numberOfInstance</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">=0;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   private Captain2() {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">numberOfInstance</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">++;</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;Number of instances at this moment=&quot;+</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">numberOfInstance</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">);</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   public static  Captain2 getCaptain(){</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">       if (</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic; font-weight: bold;">captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">== null) {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">           synchronized (Captain2.class) {</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">               // Lazy initialization</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">               if (</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic; font-weight: bold;">captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-weight: bold;">== null){</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">                   </span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">= new Captain2();</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">                   System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;New captain is elected for your team.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">               }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">               else</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">               {</span></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">                   System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.print(&quot;You already have a captain for your team.&quot;);</span></font></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">                   System.</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">out</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">.println(&quot;Send him for the toss.&quot;);</span></font></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">               }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">           }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">       return</span> <span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace; font-style: italic;">captain</span><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">;</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">   }</span></div><div><span style="font-size: 10pt; font-family: &quot;Source Code Pro&quot;, monospace;">}</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 10pt;">If you notice our synchronized implementation of the singleton pattern, you may find that synchronization operations are costly in general and the approach is useful for some initial threads that might break the singleton implementation. But in later phases, the synchronization operations might create additional overhead. To avoid that problem, you can use a synchronized block inside an if condition, as shown in the following code, to ensure that no unwanted instance is created.</span></div></td></tr></tbody></table><div><br/></div></div></div><div><br/></div></span>
</div></body></html> 